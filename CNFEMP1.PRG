*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        08/19/96             CNFEMP1.SPR               12:04:14 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 CNFEMP1/MS-DOS Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
SET FUNCTION F5 TO

CLOSE DATA

SELECT 1
USE employee ORDER name

SELECT 2
USE salary ORDER empno2

SELECT 3
USE salcode ORDER salcode

SELECT 4
USE deptt ORDER deptcode




SELECT 2
SET RELATION TO salcode INTO salcode ADDITIVE


SELECT 1
SET RELATION TO str(deptcode)+str(empno) INTO salary ADDITIVE
SET RELATION TO deptcode INTO deptt ADDITIVE

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     CNFEMP1/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
@ 2,10 SAY "Enter Employee Number for Confirmation:" ;
	SIZE 1,39, 0
@ 2,52 GET mDptCode ;
	SIZE 1,2 ;
	DEFAULT 0 ;
	PICTURE "99" ;
	WHEN _rd40pvef9()
@ 2,55 GET mEmpNo ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN _rd40pveld() ;
	VALID _rd40pvepz()
@ 2,54 SAY "-" ;
	SIZE 1,1, 0



READ MODAL


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      CNFEMP1/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

ON KEY

********************


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*          CNFEMP1/MS-DOS Supporting Procedures and Functions    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
PROCEDURE ShwEmpNos
********************
PUSH KEY

DEFINE WINDOW brShEmp FROM 5,5 TO 21,45 DOUBLE SHADOW;
		Title "Employees List On Probation"

ACTIVATE WINDOW brShEmp

SELECT employee
SET ORDER TO name
GOTO TOP

ON KEY LABEL F5

ON KEY LABEL ENTER DO Pick

SET FILTER TO
SET FILTER TO probation = .T. AND working = .T. AND salary.mpay = .T.

LOCATE FOR deptcode = mDptcode AND empno = mEmpNo

IF NOT FOUND()
	GOTO TOP
ENDIF


BROW FIELDS;
	deptcode :2 :H="C  ",;
	empno :H="ode",;
	name :H="   Name   ",;
	doa :P="@E";
IN WINDOW brShEmp;
NOEDIT NODELETE NOAPPEND


SET FILTER TO

RELEASE WINDOW brShEmp

POP KEY


SELECT 1
RETURN
*********************


*****************
PROCEDURE Pick
*****************

mDptCode = 0
mEmpNo = 0

PUSH KEY
CLEA GETS

mDptCode = deptcode
mEmpNo = empno

RELEASE WINDOW brShEmp

POP KEY
ON KEY LABEL ENTER
SHOW GETS

RETURN .T.
*****************

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RD40PVEF9           mDptCode WHEN                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CNFEMP1,     Record Number:    3   
*        Variable:            mDptCode                           
*        Called By:           WHEN Clause                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rd40pvef9     &&  mDptCode WHEN
#REGION 1
PUSH KEY
ON KEY LABEL F5
ON KEY LABEL F5 DO ShwEmpNos
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RD40PVELD           mEmpNo WHEN                        
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CNFEMP1,     Record Number:    4   
*        Variable:            mEmpNo                             
*        Called By:           WHEN Clause                        
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rd40pveld     &&  mEmpNo WHEN
#REGION 1
PUSH KEY
ON KEY LABEL F5
ON KEY LABEL F5 DO ShwEmpNos
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RD40PVEPZ           mEmpNo VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CNFEMP1,     Record Number:    4   
*        Variable:            mEmpNo                             
*        Called By:           VALID Clause                       
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rd40pvepz     &&  mEmpNo VALID
#REGION 1
LOCATE FOR deptcode = mDptcode AND empno = mEmpNo

IF NOT FOUND()
	WAIT WINDOW "Employee Not On Probation" TIMEOUT 1
	KEYBOARD '{F5}'
	RETURN .F.
ENDIF
ON KEY LABEL F5

RETURN .T.